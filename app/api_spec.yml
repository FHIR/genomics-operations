openapi: '3.0.3'
info:
  title: FHIR Genomics Operations
  version: '0.1'
  description: |-
    This site is a reference implementation of FHIR Genomics Operations.

    FHIR Genomics operations are based on the premise that genomic data, in FHIR format and/or some other format (e.g. <a href="https://samtools.github.io/hts-specs/VCFv4.3.pdf">VCF format</a>), are stored in a repository, either in or alongside an EHR, possibly along with phenotype annotations. The FHIR Genomics operations essentially 'wrap' the repository, presenting a uniform interface to applications, regardless of internal repository data structures.

    Click <a href="http://build.fhir.org/ig/HL7/genomics-reporting/operations.html">here</a> to Learn more about FHIR Genomics Operations

    All patient data used in this implementation is either synthetic or publicly available and anonymized. All data and code used in this implementation is open-sourced. Click <a href="https://github.com/FHIR/genomics-operations">here</a> to learn more about the reference implementation.

    Contact <a href="mailto:info@elimu.io">info@elimu.io</a> for comments on this Reference Implementation.

servers:
  - url: https://fhir-gen-ops.herokuapp.com

paths:
  /subject-operations/genotype-operations/$find-subject-variants:
    get:
      description: >
        Determine if simple variants are present that overlap range(s). (See section '<a href="http://build.fhir.org/ig/HL7/genomics-reporting/operations.html#simple-vs-structural-variant-operations">Simple vs. Structural variant operations</a>' for the distinction between simple and structural variants).
      summary: "Find Subject Variants"
      operationId: "app.endpoints.find_subject_variants"
      tags:
        - "Subject Genotype Operations"
      responses:
        '200':
          description: "Returns a FHIR Parameters resource, containing each range requested, a boolean indicating if variants are present in a range, and optionally, the variants present in a range."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: subject
          in: query
          schema:
            format: PatientID
            type: string
            example: 'HG00403'
          required: true
          description: The subject of interest.
        - name: ranges
          in: query
          required: true
          description: List of regions to be searched for variants. Must be in zero-based RefSeq:Integer-range format.
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*[Nn][A-Za-z]_\d{4,10}(\.)(\d{1,2}):\d{1,10}-\d{1,10}\s*$'
            example:
              - "NC_000019.9:11200138-11244496"
          style: "form"
          explode: false
        - name: testIdentifiers
          in: query
          description: Supply a list of test identifiers. Only results originating from one of these tests will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: testDateRange
          in: query
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*(eq|ne|lt|gt|ge|le|sa|eb)(((18|19|20)[0-9]{2}-(0?[13578]|1[02])-(0?[1-9]|[12][0-9]|3[01]))|((18|19|20)[0-9]{2}-(0?[469]|11)-(0?[1-9]|[12][0-9]|30))|((18|19|20)[0-9]{2}-(0?[2])-(0?[1-9]|1[0-9]|2[0-8]))|((((18|19|20)(04|08|[2468][048]|[13579][26]))|2000)-(0?[2])-29))\s*$'
            example:
              - "ge2010-01-01"
          description: Supply a date range. Only results generated during this range will be returned.
          style: "form"
          explode: true
        - name: specimenIdentifiers
          in: query
          description: Supply a list of specimen identifiers. Only results derived from one of these specimens will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: genomicSourceClass
          in: query
          schema:
            type: string
            pattern: '^\s*((?i:germline)|(?i:somatic))\s*$'
          description: Enables an App to limit results to those that are 'germline' or 'somatic'. Default is to include variants irrespective of genomic source class.
        - name: includeVariants
          in: query
          schema:
            type: boolean
            default: false
          description: Include variants in response if set to true.
        - name: includePhasing
          in: query
          schema:
            type: boolean
            default: false
          description: Include sequence phase relationships in response if set to true.
  
  /subject-operations/genotype-operations/$find-subject-specific-variants:
    get:
      description: >
        Determine if specified simple variants are present or not. If any specified variant instance that passes the filters is present, then presence=true, else presence=false. (See section '<a href="http://build.fhir.org/ig/HL7/genomics-reporting/operations.html#simple-vs-structural-variant-operations">Simple vs. Structural variant operations</a>' for the distinction between simple and structural variants).
      summary: "Find Subject Specific Variants"
      operationId: "app.endpoints.find_subject_specific_variants"
      tags:
        - "Subject Genotype Operations"
      responses:
        '200':
          description: "Returns a FHIR Parameters resource, containing each variant requested, a boolean indicating if variant is present or not, and the variant instance itself if present."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: subject
          in: query
          schema:
            format: PatientID
            type: string
            example: 'm123'
          required: true
          description: The subject of interest.
        - name: variants
          in: query
          required: true
          description: List of variants being sought. Must be in HGVS or SPDI format.
          schema:
            type: array
            items:
              type: string
            example:
              - "NM_001127510.3:c.145A>T"
          style: "form"
          explode: false
        - name: testIdentifiers
          in: query
          description: Supply a list of test identifiers. Only results originating from one of these tests will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: testDateRange
          in: query
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*(eq|ne|lt|gt|ge|le|sa|eb)(((18|19|20)[0-9]{2}-(0?[13578]|1[02])-(0?[1-9]|[12][0-9]|3[01]))|((18|19|20)[0-9]{2}-(0?[469]|11)-(0?[1-9]|[12][0-9]|30))|((18|19|20)[0-9]{2}-(0?[2])-(0?[1-9]|1[0-9]|2[0-8]))|((((18|19|20)(04|08|[2468][048]|[13579][26]))|2000)-(0?[2])-29))\s*$'
            example:
              - "ge2010-01-01"
          description: Supply a date range. Only results generated during this range will be returned.
          style: "form"
          explode: true
        - name: specimenIdentifiers
          in: query
          description: Supply a list of specimen identifiers. Only results derived from one of these specimens will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: genomicSourceClass
          in: query
          schema:
            type: string
            enum:
              - "germline"
              - "somatic"
          description: Enables an App to limit results to those that are 'germline' or 'somatic'. Default is to include variants irrespective of genomic source class.
  
  /subject-operations/genotype-operations/$find-subject-structural-intersecting-variants:
    get:
      description: >
        Determine if structural variants are present that intersect range(s). (See section '<a href="http://build.fhir.org/ig/HL7/genomics-reporting/operations.html#use-of-genomic-regions">Use of genomic regions</a>' for the distinction between variants that 'intersect' vs. 'subsume' a region; see section '<a href="http://build.fhir.org/ig/HL7/genomics-reporting/operations.html#simple-vs-structural-variant-operations">Simple vs. Structural variant operations</a>' for the distinction between simple and structural variants).
      summary: "Find Subject Structural Intersecting Variants"
      operationId: "app.endpoints.find_subject_structural_intersecting_variants"
      tags:
        - "Subject Genotype Operations"
      responses:
        '200':
          description: "Returns a FHIR Parameters resource, containing each range requested, a boolean indicating if variants are present in a range, and optionally, the variants present in a range."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: subject
          in: query
          schema:
            format: PatientID
            type: string
            example: 'HCC1143'
          required: true
          description: The subject of interest.
        - name: ranges
          in: query
          required: true
          description: List of regions to be searched for variants. Must be in zero-based RefSeq:Integer-range format.
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*[Nn][A-Za-z]_\d{4,10}(\.)(\d{1,2}):\d{1,10}-\d{1,10}\s*$'
            example:
              - "NC_000007.14:55019016-55211628"
              - "NC_000004.12:54727415-54727542"
          style: "form"
          explode: false
        - name: testIdentifiers
          in: query
          description: Supply a list of test identifiers. Only results originating from one of these tests will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: testDateRange
          in: query
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*(eq|ne|lt|gt|ge|le|sa|eb)(((18|19|20)[0-9]{2}-(0?[13578]|1[02])-(0?[1-9]|[12][0-9]|3[01]))|((18|19|20)[0-9]{2}-(0?[469]|11)-(0?[1-9]|[12][0-9]|30))|((18|19|20)[0-9]{2}-(0?[2])-(0?[1-9]|1[0-9]|2[0-8]))|((((18|19|20)(04|08|[2468][048]|[13579][26]))|2000)-(0?[2])-29))\s*$'
            example:
              - "ge2010-01-01"
          description: Supply a date range. Only results generated during this range will be returned.
          style: "form"
          explode: true
        - name: specimenIdentifiers
          in: query
          description: Supply a list of specimen identifiers. Only results derived from one of these specimens will be returned.
          schema:
            type: array
            items:
              type: string
            example:
              - "HCC1143-Sp1"
          style: "form"
          explode: false
        - name: genomicSourceClass
          in: query
          schema:
            type: string
            enum:
              - "germline"
              - "somatic"
          description: Enables an App to limit results to those that are 'germline' or 'somatic'. Default is to include variants irrespective of genomic source class.
        - name: includeVariants
          in: query
          schema:
            type: boolean
            default: false
          description: Include variants in response if set to true.
  
  /subject-operations/genotype-operations/$find-subject-structural-subsuming-variants:
    get:
      description: >
        Determine if structural variants are present that subsume range(s). (See section '<a href="http://build.fhir.org/ig/HL7/genomics-reporting/operations.html#use-of-genomic-regions">Use of genomic regions</a>' for the distinction between variants that 'intersect' vs. 'subsume' a region; see section '<a href="http://build.fhir.org/ig/HL7/genomics-reporting/operations.html#simple-vs-structural-variant-operations">Simple vs. Structural variant operations</a>' for the distinction between simple and structural variants).
      summary: "Find Subject Structural Subsuming Variants"
      operationId: "app.endpoints.find_subject_structural_subsuming_variants"
      tags:
        - "Subject Genotype Operations"
      responses:
        '200':
          description: "Returns a FHIR Parameters resource, containing each range requested, a boolean indicating if variants are present in a range, and optionally, the variants present in a range."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: subject
          in: query
          schema:
            format: PatientID
            type: string
            example: 'HCC1143'
          required: true
          description: The subject of interest.
        - name: ranges
          in: query
          required: true
          description: List of regions to be searched for variants. Must be in zero-based RefSeq:Integer-range format.
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*[Nn][A-Za-z]_\d{4,10}(\.)(\d{1,2}):\d{1,10}-\d{1,10}\s*$'
            example:
              - "NC_000007.14:116672195-116798386"
          style: "form"
          explode: false
        - name: testIdentifiers
          in: query
          description: Supply a list of test identifiers. Only results originating from one of these tests will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: testDateRange
          in: query
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*(eq|ne|lt|gt|ge|le|sa|eb)(((18|19|20)[0-9]{2}-(0?[13578]|1[02])-(0?[1-9]|[12][0-9]|3[01]))|((18|19|20)[0-9]{2}-(0?[469]|11)-(0?[1-9]|[12][0-9]|30))|((18|19|20)[0-9]{2}-(0?[2])-(0?[1-9]|1[0-9]|2[0-8]))|((((18|19|20)(04|08|[2468][048]|[13579][26]))|2000)-(0?[2])-29))\s*$'
            example:
              - "ge2010-01-01"
          description: Supply a date range. Only results generated during this range will be returned.
          style: "form"
          explode: true
        - name: specimenIdentifiers
          in: query
          description: Supply a list of specimen identifiers. Only results derived from one of these specimens will be returned.
          schema:
            type: array
            items:
              type: string
            example:
              - "HCC1143-Sp1"
          style: "form"
          explode: false
        - name: genomicSourceClass
          in: query
          schema:
            type: string
            enum:
              - "germline"
              - "somatic"
          description: Enables an App to limit results to those that are 'germline' or 'somatic'. Default is to include variants irrespective of genomic source class.
        - name: includeVariants
          in: query
          schema:
            type: boolean
            default: false
          description: Include variants in response if set to true.
  
  /subject-operations/genotype-operations/$find-subject-haplotypes:
    get:
      description: >
        Retrieve haplotypes/genotypes of specified genes.
      summary: "Find Subject Haplotypes"
      operationId: "app.endpoints.find_subject_haplotypes"
      tags:
        - "Subject Genotype Operations"
      responses:
        '200':
          description: "Returns a FHIR Parameters resource, containing each gene requested, the genotype instance itself if present."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: subject
          in: query
          schema:
            format: PatientID
            type: string
            example: 'NB6TK328'
          required: true
          description: The subject of interest.
        - name: genes
          in: query
          required: true
          description: List of genes to be searched. Must be in token or codesystem|code format.
          schema:
            type: array
            items:
              type: string
            example:
              - "http://www.genenames.org/geneId|HGNC:2625"
              - "http://www.genenames.org/geneId|HGNC:2621"
          style: "form"
          explode: false
        - name: testIdentifiers
          in: query
          description: Supply a list of test identifiers. Only results originating from one of these tests will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: testDateRange
          in: query
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*(eq|ne|lt|gt|ge|le|sa|eb)(((18|19|20)[0-9]{2}-(0?[13578]|1[02])-(0?[1-9]|[12][0-9]|3[01]))|((18|19|20)[0-9]{2}-(0?[469]|11)-(0?[1-9]|[12][0-9]|30))|((18|19|20)[0-9]{2}-(0?[2])-(0?[1-9]|1[0-9]|2[0-8]))|((((18|19|20)(04|08|[2468][048]|[13579][26]))|2000)-(0?[2])-29))\s*$'
            example:
              - "ge2010-01-01"
          description: Supply a date range. Only results generated during this range will be returned.
          style: "form"
          explode: true
        - name: specimenIdentifiers
          in: query
          description: Supply a list of specimen identifiers. Only results derived from one of these specimens will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: genomicSourceClass
          in: query
          schema:
            type: string
            enum:
              - "germline"
              - "somatic"
          description: Enables an App to limit results to those that are 'germline' or 'somatic'. Default is to include variants irrespective of genomic source class.
  
  /subject-operations/genotype-operations/$find-subject-specific-haplotypes:
    get:
      description: >
        See if specified haplotypes/genotypes are present.
      summary: "Find Subject Specific Haplotypes"
      operationId: "app.endpoints.find_subject_specific_haplotypes"
      tags:
        - "Subject Genotype Operations"
      responses:
        '200':
          description: "Returns a FHIR Parameters resource, containing each haplotype requested, the genotype instance itself if present."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: subject
          in: query
          schema:
            format: PatientID
            type: string
            example: 'NB6TK328'
          required: true
          description: The subject of interest.
        - name: haplotypes
          in: query
          required: true
          description: List of haplotypes and/or genotypes being sought. Must be in token or codesystem|code format.
          schema:
            type: array
            items:
              type: string
            example:
              - "HLA-B*27"
          style: "form"
          explode: false
        - name: testIdentifiers
          in: query
          description: Supply a list of test identifiers. Only results originating from one of these tests will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: testDateRange
          in: query
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*(eq|ne|lt|gt|ge|le|sa|eb)(((18|19|20)[0-9]{2}-(0?[13578]|1[02])-(0?[1-9]|[12][0-9]|3[01]))|((18|19|20)[0-9]{2}-(0?[469]|11)-(0?[1-9]|[12][0-9]|30))|((18|19|20)[0-9]{2}-(0?[2])-(0?[1-9]|1[0-9]|2[0-8]))|((((18|19|20)(04|08|[2468][048]|[13579][26]))|2000)-(0?[2])-29))\s*$'
            example:
              - "ge2010-01-01"
          description: Supply a date range. Only results generated during this range will be returned.
          style: "form"
          explode: true
        - name: specimenIdentifiers
          in: query
          description: Supply a list of specimen identifiers. Only results derived from one of these specimens will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: genomicSourceClass
          in: query
          schema:
            type: string
            enum:
              - "germline"
              - "somatic"
          description: Enables an App to limit results to those that are 'germline' or 'somatic'. Default is to include variants irrespective of genomic source class.
  
  /subject-operations/phenotype-operations/$find-subject-tx-implications:
    get:
      description: |-
        Retrieves genetic therapeutic implications for variants/haplotypes/genotypes.

        Returned implications are those derived from a variant present in the subject that satisfy other parameter values. For instance, if only variants are provided, the operation returns identified therapeutic implications for the subset of supplied variants present in the subject. If only treatments are provided, the operation returns identified therapeutic implications where the implication is one of the supplied treatments and where the implication is derived from a variant present in the subject. If both variants and treatments are provided, the operation returns identified therapeutic implications where the implication is one of the supplied treatments and where the implication is derived from the subset of supplied variants present in the subject.

        Where no variants, haplotypes, treatments, or conditions are provided, the operation returns no implications.
      summary: "Find Subject Tx Implications"
      operationId: "app.endpoints.find_subject_tx_implications"
      tags:
        - "Subject Phenotype Operations"
      responses:
        '200':
          description: "Returns a FHIR Parameters resource, containing each therapeutic implication identified, along with those variants/haplotypes/genotypes from which the implication is derived."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: subject
          in: query
          schema:
            format: PatientID
            type: string
            example: 'NB6TK328'
          required: true
          description: The subject of interest.
        - name: variants
          in: query
          description: List of variants being sought. Must be in HGVS or SPDI format.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: ranges
          in: query
          description: List of regions to be searched for variants. Must be in zero-based RefSeq:Integer-range format.
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*[Nn][A-Za-z]_\d{4,10}(\.)(\d{1,2}):\d{1,10}-\d{1,10}\s*$'
            example:
              - "NC_000019.9:11200138-11244496"
          style: "form"
          explode: false
        - name: haplotypes
          in: query
          description: List of haplotypes and/or genotypes being sought. Must be in token or codesystem|code format.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: treatments
          in: query
          description: List of medications and/or other therapeutic interventions for which implications are sought. Must be in token or codesystem|code format.
          schema:
            type: array
            items:
              type: string
            example:
              - "http://www.nlm.nih.gov/research/umls/rxnorm|704"
          style: "form"
          explode: false
        - name: conditions
          in: query
          description: List of conditions for which implications are sought. Must be in token or codesystem|code format.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: testIdentifiers
          in: query
          description: Supply a list of test identifiers. Only results originating from one of these tests will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: testDateRange
          in: query
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*(eq|ne|lt|gt|ge|le|sa|eb)(((18|19|20)[0-9]{2}-(0?[13578]|1[02])-(0?[1-9]|[12][0-9]|3[01]))|((18|19|20)[0-9]{2}-(0?[469]|11)-(0?[1-9]|[12][0-9]|30))|((18|19|20)[0-9]{2}-(0?[2])-(0?[1-9]|1[0-9]|2[0-8]))|((((18|19|20)(04|08|[2468][048]|[13579][26]))|2000)-(0?[2])-29))\s*$'
            example:
              - "ge2010-01-01"
          description: Supply a date range. Only results generated during this range will be returned.
          style: "form"
          explode: true
        - name: specimenIdentifiers
          in: query
          description: Supply a list of specimen identifiers. Only results derived from one of these specimens will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: genomicSourceClass
          in: query
          schema:
            type: string
            enum:
              - "germline"
              - "somatic"
          description: Enables an App to limit results to those that are 'germline' or 'somatic'. Default is to include variants irrespective of genomic source class.
  
  /subject-operations/phenotype-operations/$find-subject-dx-implications:
    get:
      description: |-
        Retrieves genetic diagnostic implications for variants.

        Returned implications are those derived from a variant present in the subject that satisfy other parameter values. For instance, if only variants are provided, the operation returns identified diagnostic implications for the subset of supplied variants present in the subject. If only conditions are provided, the operation returns identified diagnostic implications where the implication is one of the supplied conditions and where the implication is derived from a variant present in the subject. If both variants and conditions are provided, the operation returns identified diagnostic implications where the implication is one of the supplied conditions and where the implication is derived from the subset of supplied variants present in the subject.

        Where no variants or conditions are provided, the operation returns no implications.
      summary: "Find Subject Dx Implications"
      operationId: "app.endpoints.find_subject_dx_implications"
      tags:
        - "Subject Phenotype Operations"
      responses:
        '200':
          description: "Returns a FHIR Parameters resource, containing each diagnostic implication identified, along with those variants from which the implication is derived."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: subject
          in: query
          schema:
            format: PatientID
            type: string
            example: 'huC30902'
          required: true
          description: The subject of interest.
        - name: variants
          in: query
          description: List of variants being sought. Must be in HGVS or SPDI format.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: ranges
          in: query
          description: List of regions to be searched for variants. Must be in zero-based RefSeq:Integer-range format.
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*[Nn][A-Za-z]_\d{4,10}(\.)(\d{1,2}):\d{1,10}-\d{1,10}\s*$'
            example:
              - "NC_000019.9:11200138-11244496"
          style: "form"
          explode: false
        - name: conditions
          in: query
          description: List of conditions for which implications are sought. Must be in token or codesystem|code format.
          schema:
            type: array
            items:
              type: string
            example:
              - "https://www.ncbi.nlm.nih.gov/medgen|C1708353"
          style: "form"
          explode: false
        - name: testIdentifiers
          in: query
          description: Supply a list of test identifiers. Only results originating from one of these tests will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: testDateRange
          in: query
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*(eq|ne|lt|gt|ge|le|sa|eb)(((18|19|20)[0-9]{2}-(0?[13578]|1[02])-(0?[1-9]|[12][0-9]|3[01]))|((18|19|20)[0-9]{2}-(0?[469]|11)-(0?[1-9]|[12][0-9]|30))|((18|19|20)[0-9]{2}-(0?[2])-(0?[1-9]|1[0-9]|2[0-8]))|((((18|19|20)(04|08|[2468][048]|[13579][26]))|2000)-(0?[2])-29))\s*$'
            example:
              - "ge2010-01-01"
          description: Supply a date range. Only results generated during this range will be returned.
          style: "form"
          explode: true
        - name: specimenIdentifiers
          in: query
          description: Supply a list of specimen identifiers. Only results derived from one of these specimens will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: genomicSourceClass
          in: query
          schema:
            type: string
            enum:
              - "germline"
              - "somatic"
          description: Enables an App to limit results to those that are 'germline' or 'somatic'. Default is to include variants irrespective of genomic source class.
  
  /subject-operations/metadata-operations/$find-study-metadata:
    get:
      description: |-
        Retrieve metadata about sequencing studies performed on a subject.
      summary: "Find Study Metadata"
      operationId: "app.endpoints.find_study_metadata"
      tags:
        - "Subject Metadata Operations"
      responses:
        '200':
          description: "Returns a list of identified sequencing studies with associated study metadata."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: subject
          in: query
          schema:
            format: PatientID
            type: string
            example: 'HCC1143'
          required: true
          description: The subject of interest.
        - name: testIdentifiers
          in: query
          description: Supply a list of test identifiers. Only results originating from one of these tests will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: testDateRange
          in: query
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*(eq|ne|lt|gt|ge|le|sa|eb)(((18|19|20)[0-9]{2}-(0?[13578]|1[02])-(0?[1-9]|[12][0-9]|3[01]))|((18|19|20)[0-9]{2}-(0?[469]|11)-(0?[1-9]|[12][0-9]|30))|((18|19|20)[0-9]{2}-(0?[2])-(0?[1-9]|1[0-9]|2[0-8]))|((((18|19|20)(04|08|[2468][048]|[13579][26]))|2000)-(0?[2])-29))\s*$'
            example:
              - "ge2010-01-01"
          description: Supply a date range. Only results generated during this range will be returned.
          style: "form"
          explode: true
        - name: specimenIdentifiers
          in: query
          description: Supply a list of specimen identifiers. Only results derived from one of these specimens will be returned.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: ranges
          in: query
          description: List of regions to be searched for variants. Must be in zero-based RefSeq:Integer-range format.
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*[Nn][A-Za-z]_\d{4,10}(\.)(\d{1,2}):\d{1,10}-\d{1,10}\s*$'
            example:
              - "NC_000007.14:55019016-55211628"
          style: "form"
          explode: false

  /population-operations/genotype-operations/$find-population-specific-variants:
    get:
      description: |-
        Retrieve count or list of patients having specified variants.

        Population queries are designed to return a count of patients that match each item sought, with or without a list of patients matching the item(s) sought.
      summary: "Find Population Specific Variants"
      operationId: "app.endpoints.find_population_specific_variants"
      tags:
        - "Population Genotype Operations"
      responses:
        '200':
          description: "Returns a FHIR Parameters resource, containing each variant requested, a boolean indicating if variant is present or not, and the variant instance itself if present."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: variants
          in: query
          required: true
          description: List of variants being sought. Must be in HGVS or SPDI format.
          schema:
            type: array
            items:
              type: string
            example:
              - "NC_000001.10:144931726:G:A"
              - "NC_000001.10:145532548:T:C"
              - "NC_000001.10:145592072:A:T"
          style: "pipeDelimited"
          explode: true
        - name: genomicSourceClass
          in: query
          schema:
            type: string
            enum:
              - "germline"
              - "somatic"
          description: Enables an App to limit results to those that are 'germline' or 'somatic'. Default is to include variants irrespective of genomic source class.
        - name: includePatientList
          in: query
          schema:
            type: boolean
            default: false
          description: Include list of matching patients if set to true.

  /population-operations/genotype-operations/$find-population-structural-intersecting-variants:
    get:
      description: |-
        Retrieve count or list of patients having structural intersecting variants in specified regions. (See section '<a href="http://build.fhir.org/ig/HL7/genomics-reporting/operations.html#genes-vs-regions">Genes vs. Regions</a>' for the distinction between variants that 'intersect' vs. 'subsume' a region).

        A patient meets numerator criteria if they have at least one structural variant intersecting a given range.

        Population queries are designed to return a count of patients that match each item sought, with or without a list of patients matching the item(s) sought.
      summary: "Find Population Structural Intersecting Variants"
      operationId: "app.endpoints.find_population_structural_intersecting_variants"
      tags:
        - "Population Genotype Operations"
      responses:
        '200':
          description: "Returns a FHIR Parameters resource containing ranges sought along with a count +/- list of patients having at least one structural variant intersecting that range."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: ranges
          in: query
          required: true
          description: List of regions to be searched for variants. Must be in zero-based RefSeq:Integer-range format.
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*[Nn][A-Za-z]_\d{4,10}(\.)(\d{1,2}):\d{1,10}-\d{1,10}\s*$'
            example:
              - "NC_000017.11:43044294-43125364"
              - "NC_000013.11:32315507-32400268"
          style: "form"
          explode: false
        - name: genomicSourceClass
          in: query
          schema:
            type: string
            enum:
              - "germline"
              - "somatic"
          description: Enables an App to limit results to those that are 'germline' or 'somatic'. Default is to include variants irrespective of genomic source class.
        - name: includePatientList
          in: query
          schema:
            type: boolean
            default: false
          description: Include list of matching patients if set to true.

  /population-operations/genotype-operations/$find-population-structural-subsuming-variants:
    get:
      description: |-
        Retrieve count or list of patients having structural subsuming variants in specified regions. (See section '<a href="http://build.fhir.org/ig/HL7/genomics-reporting/operations.html#genes-vs-regions">Genes vs. Regions</a>' for the distinction between variants that 'intersect' vs. 'subsume' a region).

        A patient meets numerator criteria if they have at least one structural variant subsuming a given range.

        Population queries are designed to return a count of patients that match each item sought, with or without a list of patients matching the item(s) sought.
      summary: "Find Population Structural Subsuming Variants"
      operationId: "app.endpoints.find_population_structural_subsuming_variants"
      tags:
        - "Population Genotype Operations"
      responses:
        '200':
          description: "Returns a FHIR Parameters resource containing ranges sought along with a count +/- list of patients having at least one structural variant subsuming that range."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: ranges
          in: query
          required: true
          description: List of regions to be searched for variants. Must be in zero-based RefSeq:Integer-range format.
          schema:
            type: array
            items:
              type: string
              pattern: '^\s*[Nn][A-Za-z]_\d{4,10}(\.)(\d{1,2}):\d{1,10}-\d{1,10}\s*$'
            example:
              - "NC_000017.10:37844346-37884911"
              - "NC_000007.13:116312249-116438431"
          style: "form"
          explode: false
        - name: genomicSourceClass
          in: query
          schema:
            type: string
            enum:
              - "germline"
              - "somatic"
          description: Enables an App to limit results to those that are 'germline' or 'somatic'. Default is to include variants irrespective of genomic source class.
        - name: includePatientList
          in: query
          schema:
            type: boolean
            default: false
          description: Include list of matching patients if set to true.

  /population-operations/genotype-operations/$find-population-specific-haplotypes:
    get:
      description: |-
        Retrieve count or list of patients having specified genotypes/haplotypes.

        Population queries are designed to return a count of patients that match each item sought, with or without a list of patients matching the item(s) sought.
      summary: "Find Population Specific Haplotypes"
      operationId: "app.endpoints.find_population_specific_haplotypes"
      tags:
        - "Population Genotype Operations"
      responses:
        '200':
          description: "Returns a FHIR Parameters resource containing haplotypes/genotypes sought along with a count +/- list of matching patients."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: haplotypes
          in: query
          required: true
          description: List of haplotypes and/or genotypes being sought. Must be in token or codesystem|code format.
          schema:
            type: array
            items:
              type: string
            example:
              - "CYP2C19"
          style: "pipeDelimited"
          explode: true
        - name: genomicSourceClass
          in: query
          schema:
            type: string
            enum:
              - "germline"
              - "somatic"
          description: Enables an App to limit results to those that are 'germline' or 'somatic'. Default is to include variants irrespective of genomic source class.
        - name: includePatientList
          in: query
          schema:
            type: boolean
            default: false
          description: Include list of matching patients if set to true.

  /population-operations/phenotype-operations/$find-population-tx-implications:
    get:
      description: |-
        Retrieve count or list of patients having therapeutic implications. More specifically, this operation retrieves the count +/- list of patients that have therapeutic implications involving specific treatments and/or conditions, derived from specific variants/haplotypes/genotypes.

        A patient meets numerator criteria if they have at least one therapeutic implication matching the query parameters.
      summary: "Find Population Tx Implications"
      operationId: "app.endpoints.find_population_tx_implications"
      tags:
        - "Population Phenotype Operations"
      responses:
        '200':
          description: "Returns a FHIR Parameters resource containing a count +/- list of patients having at least one matching therapeutic implication."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: variants
          in: query
          description: List of variants from which implications are derived. Must be in HGVS or SPDI format.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: haplotypes
          in: query
          description: List of haplotypes from which implications are derived. Must be in token or codesystem|code format.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: treatments
          in: query
          description: List of medications and/or other therapeutic interventions for which implications are sought. Must be in token or codesystem|code format.
          schema:
            type: array
            items:
              type: string
            example:
              - "http://www.nlm.nih.gov/research/umls/rxnorm|704"
          style: "form"
          explode: false
        - name: conditions
          in: query
          description: List of conditions for which implications are sought. Must be in token or codesystem|code format.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: genomicSourceClass
          in: query
          schema:
            type: string
            enum:
              - "germline"
              - "somatic"
          description: Enables an App to limit results to those that are 'germline' or 'somatic'. Default is to include variants irrespective of genomic source class.
        - name: includePatientList
          in: query
          schema:
            type: boolean
            default: false
          description: Include list of matching patients if set to true.

  /population-operations/phenotype-operations/$find-population-dx-implications:
    get:
      description: |-
        Retrieve count or list of patients having diagnostic implications. More specifically, this operation retrieves the count +/- list of patients that have diagnostic implications involving specific treatments and/or conditions, derived from specific variants/haplotypes/genotypes.

        A patient meets numerator criteria if they have at least one diagnostic implication matching the query parameters.
      summary: "Find Population Dx Implications"
      operationId: "app.endpoints.find_population_dx_implications"
      tags:
        - "Population Phenotype Operations"
      responses:
        '200':
          description: "Returns a FHIR Parameters resource containing a count +/- list of patients having at least one matching diagnostic implication."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: variants
          in: query
          description: List of variants from which implications are derived. Must be in HGVS or SPDI format.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: haplotypes
          in: query
          description: List of haplotypes from which implications are derived. Must be in token or codesystem|code format.
          schema:
            type: array
            items:
              type: string
          style: "form"
          explode: false
        - name: conditions
          in: query
          description: List of conditions for which implications are sought. Must be in token or codesystem|code format.
          schema:
            type: array
            items:
              type: string
            example:
              - "https://www.ncbi.nlm.nih.gov/medgen|C0677776"
              - "https://www.ncbi.nlm.nih.gov/medgen|C4552100"
              - "https://www.ncbi.nlm.nih.gov/medgen|C0020445"
          style: "form"
          explode: false
        - name: genomicSourceClass
          in: query
          schema:
            type: string
            enum:
              - "germline"
              - "somatic"
          description: Enables an App to limit results to those that are 'germline' or 'somatic'. Default is to include variants irrespective of genomic source class.
        - name: includePatientList
          in: query
          schema:
            type: boolean
            default: false
          description: Include list of matching patients if set to true.

  /utilities/get-feature-coordinates:
    get:
      summary: "Get Feature Coordinates"
      operationId: "app.utilities_endpoints.get_feature_coordinates"
      tags:
        - "Feature Coordinates Utility"
      responses:
        '200':
          description: ""
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: chromosome
          in: query
          description: Valid entries include chr1..chr22, chrX, chrY, chrM.
          schema:
            type: string
            pattern: '^\s*(?i:chr)([1-9]|1[0-9]|2[0-2]|[XxYyMm])\s*$'
          example: "chr1"
        - name: gene
          in: query
          description: Valid entries include an HGNC gene symbol or an HGNC gene ID (optionally prefixed with ‘HGNC:’).
          schema:
            type: string
          example: "HGNC:5"
        - name: transcript
          in: query
          description: Valid entries are NCBI transcript reference sequences (starting with ‘NM_’). (Version numbers are ignored - the latest version is always returned).
          schema:
            type: string
            pattern: '^\s*[Nn][Mm]_\d{4,10}(\.)?(\d{1,2})?\s*$'
          example: "NM_000014.6"
        - name: protein
          in: query
          description: Valid entries are NCBI protein reference sequences (starting with ‘NP_’). (Version numbers are ignored - the latest version is always returned).
          schema:
            type: string
            pattern: '^\s*[Nn][Pp]_\d{4,10}(\.)?(\d{1,2})?\s*$'
          example: "NP_000005.3"
  /utilities/find-the-gene:
    get:
      summary: "Find The Gene"
      operationId: "app.utilities_endpoints.find_the_gene"
      tags:
        - "Find The Gene Utility"
      responses:
        '200':
          description: "Returns all genes that intersect with a provided genomic region."
          content:
            application/json:
              schema:
                type: object
      parameters:
        - name: range
          in: query
          required: true
          description: Genomic region to be searched for genes. Must be in zero-based RefSeq:Integer-range format.
          schema:
            type: string
            pattern: '^\s*[Nn][Cc]_\d{4,10}(\.)(\d{1,2}):\d{1,10}-\d{1,10}\s*$'
            example: "NC_000001.11:11794399-11794400"

tags:
  - name: Subject Genotype Operations
  - name: Subject Phenotype Operations
  - name: Subject Metadata Operations
  - name: Population Genotype Operations
  - name: Population Phenotype Operations
  - name: Feature Coordinates Utility
    description: This utility returns genomic feature coordinates and other annotations. All data are from <a href="https://www.ncbi.nlm.nih.gov/genome/guide/human/">NCBI Human Genome Resources</a>. For chromosomes, build 37 and build 38 reference sequences are returned. For genes, genomic coordinates are returned, along with a list of transcripts. MANE transcript is flagged. For transcripts, genomic coordinates are returned, along with the gene name and composite exons, along with exon coordinates. For proteins, the corresponding transcript is returned.
  
  - name: Find The Gene Utility
    description: This utility returns all genes that intersect with a provided genomic region.

